<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For You <3</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: black;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Courier New', Courier, monospace;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent; /* Hilangkan highlight klik di HP */
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
        }

        #bgCanvas { z-index: 1; opacity: 0.4; }
        #fgCanvas { z-index: 2; }

        /* Teks Final (I Love You) */
        #final-text-container {
            position: relative;
            z-index: 10;
            text-align: center;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
            opacity: 0;
            transition: opacity 1.5s ease;
            pointer-events: none;
            width: 100%;
            padding: 0 20px;
            box-sizing: border-box;
        }

        .final-text { font-size: 3.5rem; color: #ffffff; }
        .final-subtext { font-size: 2rem; color: #ffffff; margin-top: 10px; }

        /* Pesan Tersembunyi (Hidden Message) - Responsif */
        #hidden-message-box {
            position: absolute;
            z-index: 20;
            width: 85%;
            max-width: 600px;
            max-height: 80vh; /* Agar tidak melebihi tinggi layar HP */
            overflow-y: auto; /* Scroll jika teks kepanjangan di HP kecil */
            background: rgba(0, 0, 0, 0.9);
            padding: 25px;
            border: 1px solid #ff69b4;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(255, 105, 180, 0.4);
            display: none;
            text-align: left;
            box-sizing: border-box;
        }

        .typing-text {
            color: #fff;
            font-size: 1rem;
            line-height: 1.5;
            white-space: pre-wrap;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .cursor {
            display: inline-block;
            width: 5px;
            background-color: #ff69b4;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .hint {
            position: absolute;
            bottom: 30px;
            color: rgba(255, 255, 255, 0.4);
            font-size: 0.9rem;
            z-index: 15;
            opacity: 0;
            transition: opacity 2s;
            animation: pulseHint 2s infinite;
            text-align: center;
            width: 100%;
        }
        
        @keyframes pulseHint {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 0.8; }
        }

        /* MEDIA QUERIES UNTUK HP */
        @media (max-width: 600px) {
            .final-text { font-size: 2.5rem; }
            .final-subtext { font-size: 1.5rem; }
            #hidden-message-box {
                width: 90%;
                padding: 20px;
            }
            .typing-text {
                font-size: 0.9rem; /* Font lebih kecil dikit di HP */
            }
        }
    </style>
</head>
<body>

    <canvas id="bgCanvas"></canvas>
    <canvas id="fgCanvas"></canvas>
    
    <div id="final-text-container">
        <div class="final-text">I Love You</div>
        <div class="final-subtext">Amelia</div>
    </div>

    <div id="hidden-message-box">
        <span id="typed-content" class="typing-text"></span><span class="cursor">&nbsp;</span>
    </div>

    <div class="hint" id="click-hint">(Klik layar untuk pesan tersembunyi)</div>

    <script>
        const bgCanvas = document.getElementById('bgCanvas');
        const bgCtx = bgCanvas.getContext('2d');
        const fgCanvas = document.getElementById('fgCanvas');
        const fgCtx = fgCanvas.getContext('2d');
        const finalTextContainer = document.getElementById('final-text-container');
        const hiddenMessageBox = document.getElementById('hidden-message-box');
        const typedContent = document.getElementById('typed-content');
        const clickHint = document.getElementById('click-hint');

        let w, h;
        // Cek apakah perangkat HP (lebar kurang dari 768px)
        let isMobile = window.innerWidth < 768;

        function resize() {
            w = bgCanvas.width = fgCanvas.width = window.innerWidth;
            h = bgCanvas.height = fgCanvas.height = window.innerHeight;
            isMobile = window.innerWidth < 768;
        }
        window.addEventListener('resize', resize);
        resize();

        // ==========================================
        // 1. MATRIX RAIN
        // ==========================================
        const matrixChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890@#$%^&*<>';
        const fontSize = 14;
        let columns = Math.floor(w / fontSize);
        let drops = [];
        for (let i = 0; i < columns; i++) drops[i] = Math.random() * -100;

        function drawMatrix() {
            bgCtx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            bgCtx.fillRect(0, 0, w, h);
            bgCtx.fillStyle = '#ff69b4'; 
            bgCtx.font = fontSize + 'px monospace';

            for (let i = 0; i < drops.length; i++) {
                const text = matrixChars.charAt(Math.floor(Math.random() * matrixChars.length));
                bgCtx.fillText(text, i * fontSize, drops[i] * fontSize);
                if (drops[i] * fontSize > h && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            }
            requestAnimationFrame(drawMatrix);
        }

        // ==========================================
        // 2. PARTICLE SYSTEM
        // ==========================================
        let particles = [];
        // Kurangi partikel di HP biar tidak lag
        const maxParticles = isMobile ? 2000 : 3000; 
        
        for (let i = 0; i < maxParticles; i++) {
            particles.push({
                x: w / 2, y: h / 2,
                tx: w / 2, ty: h / 2,
                color: 'white',
                size: Math.random() * 2 + 1,
                alpha: 0,
                active: false 
            });
        }

        function getTextCoordinates(text, textSize) {
            const offScreenCanvas = document.createElement('canvas');
            offScreenCanvas.width = w;
            offScreenCanvas.height = h;
            const ctx = offScreenCanvas.getContext('2d');
            
            // Adjust font size limit for mobile
            // Jika mobile, pastikan font tidak terlalu lebar melebihi layar
            let finalSize = textSize;
            if (isMobile) {
                // Skala kasar agar muat di layar HP potrait
                finalSize = Math.min(textSize, w / (text.length * 0.7)); 
            }

            ctx.font = `bold ${finalSize}px Arial`;
            ctx.fillStyle = 'white';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(text, w / 2, h / 2);
            const imageData = ctx.getImageData(0, 0, w, h).data;
            let points = [];
            
            // Di HP scan lebih jarang (step lebih besar) biar ringan
            const step = isMobile ? 4 : 3; 

            for (let y = 0; y < h; y += step) {
                for (let x = 0; x < w; x += step) {
                    if (imageData[(y * w + x) * 4 + 3] > 128) {
                        points.push({ x: x, y: y });
                    }
                }
            }
            return points;
        }

        function getHeartCoordinates() {
            let points = [];
            for (let i = 0; i < maxParticles; i++) {
                let t = Math.random() * Math.PI * 2;
                let jitter = (Math.random() - 0.5) * 30; 
                // Scale hati menyesuaikan lebar layar
                let scale = Math.min(w, h) / (isMobile ? 35 : 30); 
                let x = 16 * Math.pow(Math.sin(t), 3);
                let y = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
                points.push({
                    x: w / 2 + x * scale + jitter,
                    y: h / 2 + y * scale + jitter,
                    originX: w / 2 + x * scale,
                    originY: h / 2 + y * scale
                });
            }
            return points;
        }

        let state = 'idle'; 
        let heartPoints = []; 

        function updateParticles() {
            fgCtx.clearRect(0, 0, w, h);
            
            let beatScale = 1;
            if (state === 'heart') {
                let time = Date.now() * 0.003;
                beatScale = 1 + Math.sin(time) * 0.05;
            }

            const easeFactor = 0.08; 

            particles.forEach((p, index) => {
                if (p.alpha > 0.01 || p.active) {
                    let targetX = p.tx;
                    let targetY = p.ty;

                    if (state === 'heart' && heartPoints[index]) {
                        let hp = heartPoints[index];
                        let dx = hp.originX - w/2;
                        let dy = hp.originY - h/2;
                        targetX = w/2 + dx * beatScale + (p.tx - hp.originX);
                        targetY = h/2 + dy * beatScale + (p.ty - hp.originY);
                    }

                    p.x += (targetX - p.x) * easeFactor; 
                    p.y += (targetY - p.y) * easeFactor;

                    fgCtx.globalAlpha = p.alpha; 
                    fgCtx.fillStyle = p.color;
                    fgCtx.beginPath();
                    fgCtx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    fgCtx.fill();
                }
            });
            fgCtx.globalAlpha = 1; 
            requestAnimationFrame(updateParticles);
        }

        function scatterParticles() {
            particles.forEach(p => {
                if (p.alpha > 0.1) {
                    const angle = Math.random() * Math.PI * 2;
                    // Jarak scatter menyesuaikan ukuran layar
                    const dist = Math.random() * (isMobile ? 80 : 150) + 50; 
                    p.tx = p.x + Math.cos(angle) * dist;
                    p.ty = p.y + Math.sin(angle) * dist;
                }
            });
        }

        function formText(text, size = 150) {
            state = 'morphing';
            let points = getTextCoordinates(text, size);
            points.sort(() => Math.random() - 0.5);
            particles.forEach((p, i) => {
                if (i < points.length) {
                    p.active = true;
                    p.tx = points[i].x;
                    p.ty = points[i].y;
                    p.color = '#ffffff'; 
                    if (p.alpha < 0.1) fadeParticleIn(p);
                    else p.alpha = 1;
                } else {
                    fadeParticleOut(p);
                    p.active = false;
                }
            });
        }

        function fadeParticleIn(p) {
            let interval = setInterval(() => {
                p.alpha += 0.05;
                if(p.alpha >= 1) { p.alpha = 1; clearInterval(interval); }
            }, 20);
        }
        function fadeParticleOut(p) {
            let interval = setInterval(() => {
                p.alpha -= 0.05;
                if(p.alpha <= 0) { p.alpha = 0; clearInterval(interval); }
            }, 20);
        }

        function formHeart() {
            state = 'heart';
            heartPoints = getHeartCoordinates(); 
            particles.forEach((p, i) => {
                p.active = true;
                p.tx = heartPoints[i].x;
                p.ty = heartPoints[i].y;
                p.color = Math.random() > 0.5 ? '#ff1493' : '#ff69b4';
                fadeParticleIn(p);
            });
        }

        function sleep(ms) { return new Promise(resolve => setTimeout(resolve, ms)); }

        // ==========================================
        // 3. PESAN TERSEMBUNYI
        // ==========================================
        let isSequenceFinished = false;
        let isMessageShown = false;

        const hiddenMessageText = `Amelia...

aku minta maaf, aku tau emg aku salah ,blm bisa buat ngerubah kebiasaan jelek aku, tapi emangnya aku mau terus begitu?ga..

aku susah buat bangun emgnya aku mau?aku pun berusaha gimana caranya buat bangun, aku jga gapengen biar bangun sore, aku berterima kasih banget ke kamu, aku tau emg ga mudah buat aku ngerubah kebiasaan itu, aku pun udah ga begadang lagi dimana sampai pagi atau bablasin lagi, sekarang emg pr aku buat gampang bangunya, bagi aku emg gamudah apalagi aku udh gada hp sekarang buat alarm, tapi itu ga buat aku jadi males berubah kebiasaan buruk aku.

dan maaf aku tersinggung soal kamu bilang aku males malesan setiap hari, jujur dari kemarin aku ngisi waktu aku buat belajar,eksplor", nyari loker magangan juga, sebelum kamu bilg aku ngapain kek biar ga tidur lagi, waktu itu aku lgi pusing ngoding dan gatau hrs ngapain, karena aku tau kalo aku masih begitu begitu aja tidur main tidur main aku gabakal bisa jadi orang.

karena tujuan aku cuman satu yaitu kamu, sekali lagi aku minta maaf, aku belum bisa jadi orang yg kamu inginkan amelia sayang.`;

        function typeWriter(text, i, fnCallback) {
            if (i < (text.length)) {
                typedContent.innerHTML = text.substring(0, i+1);
                // Auto scroll ke bawah saat mengetik di HP
                hiddenMessageBox.scrollTop = hiddenMessageBox.scrollHeight;
                
                setTimeout(function() {
                    typeWriter(text, i + 1, fnCallback)
                }, 40); 
            } else if (typeof fnCallback == 'function') {
                fnCallback();
            }
        }

        window.addEventListener('click', () => {
            if (isSequenceFinished && !isMessageShown) {
                isMessageShown = true;
                finalTextContainer.style.opacity = 0;
                clickHint.style.opacity = 0;
                hiddenMessageBox.style.display = 'block';
                typeWriter(hiddenMessageText, 0);
            }
        });

        // ==========================================
        // 4. MAIN SEQUENCE (RESPONSIVE SIZES)
        // ==========================================
        async function startSequence() {
            drawMatrix();
            updateParticles();

            await sleep(500);

            // Logika ukuran font dinamis:
            // Jika mobile, gunakan ukuran lebih kecil. Jika desktop, ukuran asli.
            const bigSize = isMobile ? 150 : 350;
            const medSize = isMobile ? 100 : 220;

            const sequence = [
                { text: "3", size: bigSize },
                { text: "2", size: bigSize },
                { text: "1", size: bigSize },
                { text: "Are", size: medSize },
                { text: "You", size: medSize },
                { text: "My", size: medSize },
                { text: "Love?", size: medSize }
            ];

            formText(sequence[0].text, sequence[0].size);
            await sleep(2000);

            for (let i = 1; i < sequence.length; i++) {
                scatterParticles();
                await sleep(600);
                formText(sequence[i].text, sequence[i].size);
                await sleep(1500);
            }

            scatterParticles();
            await sleep(800);
            formHeart();
            
            await sleep(2000); 

            finalTextContainer.style.opacity = 1;
            
            isSequenceFinished = true;
            await sleep(1000);
            clickHint.style.opacity = 1;
        }

        startSequence();

    </script>
</body>

</html>
